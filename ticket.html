<!DOCTYPE html>

<html lang="ru">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Городской Транспорт</title>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>

        * {

            margin: 0;

            padding: 0;

            box-sizing: border-box;

            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;

            -webkit-tap-highlight-color: transparent;

            -webkit-touch-callout: none;

            -webkit-user-select: none;

            user-select: none;

        }



        html, body {

            overflow: hidden;

            position: fixed;

            width: 100%;

            height: 100%;

            background-color: white;

            -webkit-text-size-adjust: none;

        }



        body {

            display: flex;

            flex-direction: column;

            min-height: 100vh;

        }



        .container {

            width: 100%;

            padding: 0;

            background-color: white;

            display: flex;

            flex-direction: column;

            flex: 1;

            overflow-y: auto;

            padding-bottom: calc(80px + env(safe-area-inset-bottom));

        }



        .timer {

            text-align: center;

            font-size: 32px;

            margin: 20px 0;

            color: #000;

        }



        .tabs {

            display: flex;

            border-bottom: 1px solid #E0E0E0;

            margin-bottom: 16px;

            padding: 0 16px;

            justify-content: center;

        }



        .tab {

            flex: 1;

            padding: 16px 0;

            display: flex;

            align-items: center;

            justify-content: center;

            gap: 8px;

            color: #8E8E93;

            cursor: pointer;

            position: relative;

        }



        .tab.active {

            color: #000;

        }



        .tab.active:after {

            content: '';

            position: absolute;

            bottom: -1px;

            left: 0;

            right: 0;

            height: 2px;

            background: #E31E24;

        }



        .tab-icon {

            width: 24px;

            height: 24px;

        }



        .tab-content {

            display: none;

            padding: 0 16px;

        }



        .tab-content.active {

            display: block;

        }



        .info-row {

            display: flex;

            align-items: center;

            padding: 16px 0;

            border-bottom: 1px solid #E0E0E0;

        }



        .info-row:last-child {

            border-bottom: none;

        }



        .info-icon {

            width: 24px;

            height: 24px;

            margin-right: 12px;

            color: #8E8E93;

        }



        .info-content {

            flex: 1;

        }



        .info-label {

            font-size: 15px;

            color: #8E8E93;

            margin-bottom: 4px;

        }



        .info-value {

            font-size: 17px;

            color: #000;

        }



        .ticket-number {

            color: #E31E24;

            font-size: 20px;

            font-weight: 500;

        }



        .close-button {

            position: fixed;

            bottom: 16px;

            left: 16px;

            right: 16px;

            background: #E31E24;

            color: white;

            border: none;

            padding: 16px;

            border-radius: 14px;

            font-size: 17px;

            cursor: pointer;

        }



        #qr-code {

            width: 240px;

            height: 240px;

            margin: 20px auto;

            display: block;

        }



        .control-info {

            text-align: center;

            margin: 20px 0;

            color: #000;

            font-size: 17px;

        }

    </style>

</head>

<body>

    <div class="container">

        <div class="timer" id="timer">Действует: 15 сек.</div>



        <div class="tabs">

            <div class="tab active" data-tab="ticket">

                <div class="tab-icon">

                    <svg viewBox="0 0 576 512" fill="currentColor">

                        <path d="M320 48H63.1C55.16 48 47.1 55.16 47.1 64V448C47.1 456.8 55.16 464 63.1 464H284.5C296.5 482.4 311.9 498.5 329.7 511.3C326.6 511.7 323.3 512 320 512H64C28.65 512 0 483.3 0 448V64C0 28.65 28.65 0 64 0H320C355.3 0 384 28.65 384 64V198.6C366.8 203.5 350.6 210.9 336 220.5V63.1C336 55.16 328.8 47.1 320 47.1L320 48z"/>

                    </svg>

                </div>

                <span class="ticket-number" id="ticket-number"></span>

            </div>

            <div class="tab" data-tab="control">

                <div class="tab-icon">

                    <svg viewBox="0 0 448 512" fill="currentColor">

                        <path d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0S96 57.3 96 128s57.3 128 128 128zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"/>

                    </svg>

                </div>

                <span>Контроль</span>

            </div>

        </div>



        <div class="tab-content active" id="ticket-content">

            <div class="info-row">

                <div class="info-icon">

                    <svg viewBox="0 0 448 512" fill="currentColor">

                        <path d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0S96 57.3 96 128s57.3 128 128 128zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"/>

                    </svg>

                </div>

                <div class="info-content">

                    <div class="info-label">Перевозчик</div>

                    <div class="info-value" id="carrier"></div>

                </div>

            </div>



            <div class="info-row">

                <div class="info-icon">

                    <svg viewBox="0 0 512 512" fill="currentColor">

                        <path d="M500.3 227.7C515.9 243.3 515.9 268.7 500.3 284.3L284.3 500.3C268.7 515.9 243.3 515.9 227.7 500.3L11.72 284.3C-3.905 268.7-3.905 243.3 11.72 227.7L227.7 11.72C243.3-3.905 268.7-3.905 284.3 11.72L500.3 227.7z"/>

                    </svg>

                </div>

                <div class="info-content">

                    <div class="info-label">Маршрут</div>

                    <div class="info-value" id="route"></div>

                </div>

            </div>



            <div class="info-row">

                <div class="info-icon">

                    <svg viewBox="0 0 384 512" fill="currentColor">

                        <path d="M374.6 118.6c12.5 12.5 12.5 32.8 0 45.3l-320 320c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l320-320c12.5-12.5 32.8-12.5 45.3 0z"/>

                    </svg>

                </div>

                <div class="info-content">

                    <div class="info-label">Гос. номер</div>

                    <div class="info-value" id="vehicle"></div>

                </div>

            </div>



            <div class="info-row">

                <div class="info-icon">

                    <svg viewBox="0 0 384 512" fill="currentColor">

                        <path d="M240 32C319.5 32 384 96.47 384 176C384 255.5 319.5 320 240 320H112V368H296C309.3 368 320 378.7 320 392C320 405.3 309.3 416 296 416H112V456C112 469.3 101.3 480 88 480C74.75 480 64 469.3 64 456V416H24C10.75 416 0 405.3 0 392C0 378.7 10.75 368 24 368H64V320H24C10.75 320 0 309.3 0 296C0 282.7 10.75 272 24 272H64V79.31C64 53.18 85.18 32 111.3 32H240z"/>

                    </svg>

                </div>

                <div class="info-content">

                    <div class="info-label">Стоимость</div>

                    <div class="info-value" id="cost"></div>

                </div>

            </div>



            <div class="info-row">

                <div class="info-icon">

                    <svg viewBox="0 0 448 512" fill="currentColor">

                        <path d="M128 0c17.7 0 32 14.3 32 32V64H288V32c0-17.7 14.3-32 32-32s32 14.3 32 32V64h48c26.5 0 48 21.5 48 48v48H0V112C0 85.5 21.5 64 48 64H96V32c0-17.7 14.3-32 32-32zM0 192H448V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V192zm64 80v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16zm128 0v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H208c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H336zM64 400v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H208zm144 0c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H336z"/>

                    </svg>

                </div>

                <div class="info-content">

                    <div class="info-label">Дата покупки</div>

                    <div class="info-value" id="purchase-date"></div>

                </div>

            </div>



            <div class="info-row">

                <div class="info-icon">

                    <svg viewBox="0 0 512 512" fill="currentColor">

                        <path d="M256 512C114.6 512 0 397.4 0 256S114.6 0 256 0S512 114.6 512 256s-114.6 256-256 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"/>

                    </svg>

                </div>

                <div class="info-content">

                    <div class="info-label">Время покупки</div>

                    <div class="info-value" id="purchase-time"></div>

                </div>

            </div>

        </div>



        <div class="tab-content" id="control-content">

            <div class="control-info">

                Для проверки билета покажите QR-код контролеру

            </div>

            <img id="qr-code" alt="QR-код">

        </div>

    </div>



    <button class="close-button" id="close-button">ЗАКРЫТЬ</button>



    <script>

        // Инициализация Telegram WebApp

        window.Telegram.WebApp.ready();

        window.Telegram.WebApp.expand();



        // Получаем параметры из URL

        const urlParams = new URLSearchParams(window.location.search);

        

        // Заполняем данные билета

        document.getElementById('ticket-number').textContent = urlParams.get('code');

        document.getElementById('carrier').textContent = urlParams.get('carrier');

        document.getElementById('route').textContent = urlParams.get('route');

        document.getElementById('vehicle').textContent = urlParams.get('vehicle');

        document.getElementById('cost').textContent = `1 шт., Полный - ${urlParams.get('cost')}₽`;

        document.getElementById('purchase-date').textContent = urlParams.get('purchase_date');

        document.getElementById('purchase-time').textContent = urlParams.get('purchase_time');



        // Генерируем QR-код

        const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(urlParams.get('code'))}`;

        document.getElementById('qr-code').src = qrCodeUrl;



        // Запускаем таймер

        let timeLeft = 15;

        const timerElement = document.getElementById('timer');

        

        const timer = setInterval(() => {

            timeLeft--;

            timerElement.textContent = `Действует: ${timeLeft} сек.`;

            

            if (timeLeft <= 0) {

                clearInterval(timer);

                window.location.href = 'index.html';

            }

        }, 1000);



        // Обработчик для переключения вкладок

        document.querySelectorAll('.tab').forEach(tab => {

            tab.addEventListener('click', () => {

                const tabId = tab.getAttribute('data-tab');

                

                // Удаляем активный класс у всех вкладок и контента

                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));

                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

                

                // Добавляем активный класс выбранной вкладке и контенту

                tab.classList.add('active');

                document.getElementById(`${tabId}-content`).classList.add('active');

            });

        });



        // Обработчик для кнопки закрытия

        document.getElementById('close-button').addEventListener('click', () => {

            window.location.href = 'index.html';

        });

    </script>

</body>

</html>

